<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Programme Fidélité QR</title>
    <link rel="stylesheet" href="style.css">
    <script src="html5-qrcode.min.js"></script>
</head>
<body>
    <h1>Programme Fidélité QR</h1>

    <div id="reader" style="width:300px;"></div>
    <h2 id="status">En attente du scan...</h2>

    <script>
        function onScanSuccess(qrCodeMessage) {
            fetch("https://TON_BACKEND_RAILWAY/scan", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ client_id: qrCodeMessage })
            })
            .then(res => res.json())
            .then(data => {
                document.getElementById("status").innerText = data.message;
            });
        }

        let scanner = new Html5QrcodeScanner(
            "reader",
            { fps: 10, qrbox: 250 },
            false
        );
        scanner.render(onScanSuccess);
    </script>
</body>
</html>
